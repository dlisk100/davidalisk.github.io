---
import Layout from "../../layouts/Layout.astro";
import { getCollection } from 'astro:content';

const projects = (await getCollection('projects'))
  .filter(p => !p.data.draft)
  .sort((a,b) => {
    const dateA = a.data.updated || '';
    const dateB = b.data.updated || '';
    return dateB.localeCompare(dateA);
  });
---

<Layout title="Projects â€” David A. Lisk">
  <header class="mb-12">
    <h1 class="font-serif text-3xl sm:text-4xl font-medium text-fg mb-4">Projects</h1>
    <p class="text-muted max-w-[60ch]">Selected works and experiments.</p>
  </header>

  <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
    {projects.length > 0 ? (
      projects.map(p => (
        <a href={`/projects/${p.slug}`} class="group block p-6 h-full border border-border rounded-lg bg-surface hover:border-accent/30 hover:shadow-cardHover transition-all duration-300 flex flex-col">
          <h2 class="font-serif text-xl font-medium text-fg group-hover:text-accent transition-colors mb-2">
            {p.data.title}
          </h2>
          {p.data.summary && (
            <p class="text-muted text-sm leading-relaxed mb-4 flex-grow">
              {p.data.summary}
            </p>
          )}
          <div class="flex items-center justify-between mt-auto pt-4 border-t border-border/50">
            <div class="flex gap-2">
              {p.data.tags && p.data.tags.slice(0, 3).map(tag => (
                <span class="text-xs text-muted bg-bg px-1.5 py-0.5 rounded border border-border">#{tag}</span>
              ))}
            </div>
            {p.data.updated && (
              <time class="text-xs text-muted/60 font-mono">
                {p.data.updated}
              </time>
            )}
          </div>
        </a>
      ))
    ) : (
      <p class="text-muted italic col-span-2">No projects yet.</p>
    )}
  </div>
</Layout>
